import requests
import pickle
import json
import pandas as pd
import zipfile

def df_semantictypes(column_name, out_form):
    previous_dict = {'0': {'abbreviation': 'aapp', 'type_unique_identifier': 'T116', 'full_semantic_type_name': 'Amino Acid, Peptide, or Protein'}, '1': {'abbreviation': 'acab', 'type_unique_identifier': 'T020', 'full_semantic_type_name': 'Acquired Abnormality'}, '2': {'abbreviation': 'acty', 'type_unique_identifier': 'T052', 'full_semantic_type_name': 'Activity'}, '3': {'abbreviation': 'aggp', 'type_unique_identifier': 'T100', 'full_semantic_type_name': 'Age Group'}, '4': {'abbreviation': 'amas', 'type_unique_identifier': 'T087', 'full_semantic_type_name': 'Amino Acid Sequence'}, '5': {'abbreviation': 'amph', 'type_unique_identifier': 'T011', 'full_semantic_type_name': 'Amphibian'}, '6': {'abbreviation': 'anab', 'type_unique_identifier': 'T190', 'full_semantic_type_name': 'Anatomical Abnormality'}, '7': {'abbreviation': 'anim', 'type_unique_identifier': 'T008', 'full_semantic_type_name': 'Animal'}, '8': {'abbreviation': 'anst', 'type_unique_identifier': 'T017', 'full_semantic_type_name': 'Anatomical Structure'}, '9': {'abbreviation': 'antb', 'type_unique_identifier': 'T195', 'full_semantic_type_name': 'Antibiotic'}, '10': {'abbreviation': 'arch', 'type_unique_identifier': 'T194', 'full_semantic_type_name': 'Archaeon'}, '11': {'abbreviation': 'bacs', 'type_unique_identifier': 'T123', 'full_semantic_type_name': 'Biologically Active Substance'}, '12': {'abbreviation': 'bact', 'type_unique_identifier': 'T007', 'full_semantic_type_name': 'Bacterium'}, '13': {'abbreviation': 'bdsu', 'type_unique_identifier': 'T031', 'full_semantic_type_name': 'Body Substance'}, '14': {'abbreviation': 'bdsy', 'type_unique_identifier': 'T022', 'full_semantic_type_name': 'Body System'}, '15': {'abbreviation': 'bhvr', 'type_unique_identifier': 'T053', 'full_semantic_type_name': 'Behavior'}, '16': {'abbreviation': 'biof', 'type_unique_identifier': 'T038', 'full_semantic_type_name': 'Biologic Function'}, '17': {'abbreviation': 'bird', 'type_unique_identifier': 'T012', 'full_semantic_type_name': 'Bird'}, '18': {'abbreviation': 'blor', 'type_unique_identifier': 'T029', 'full_semantic_type_name': 'Body Location or Region'}, '19': {'abbreviation': 'bmod', 'type_unique_identifier': 'T091', 'full_semantic_type_name': 'Biomedical Occupation or Discipline'}, '20': {'abbreviation': 'bodm', 'type_unique_identifier': 'T122', 'full_semantic_type_name': 'Biomedical or Dental Material'}, '21': {'abbreviation': 'bpoc', 'type_unique_identifier': 'T023', 'full_semantic_type_name': 'Body Part, Organ, or Organ Component'}, '22': {'abbreviation': 'bsoj', 'type_unique_identifier': 'T030', 'full_semantic_type_name': 'Body Space or Junction'}, '23': {'abbreviation': 'celc', 'type_unique_identifier': 'T026', 'full_semantic_type_name': 'Cell Component'}, '24': {'abbreviation': 'celf', 'type_unique_identifier': 'T043', 'full_semantic_type_name': 'Cell Function'}, '25': {'abbreviation': 'cell', 'type_unique_identifier': 'T025', 'full_semantic_type_name': 'Cell'}, '26': {'abbreviation': 'cgab', 'type_unique_identifier': 'T019', 'full_semantic_type_name': 'Congenital Abnormality'}, '27': {'abbreviation': 'chem', 'type_unique_identifier': 'T103', 'full_semantic_type_name': 'Chemical'}, '28': {'abbreviation': 'chvf', 'type_unique_identifier': 'T120', 'full_semantic_type_name': 'Chemical Viewed Functionally'}, '29': {'abbreviation': 'chvs', 'type_unique_identifier': 'T104', 'full_semantic_type_name': 'Chemical Viewed Structurally'}, '30': {'abbreviation': 'clas', 'type_unique_identifier': 'T185', 'full_semantic_type_name': 'Classification'}, '31': {'abbreviation': 'clna', 'type_unique_identifier': 'T201', 'full_semantic_type_name': 'Clinical Attribute'}, '32': {'abbreviation': 'clnd', 'type_unique_identifier': 'T200', 'full_semantic_type_name': 'Clinical Drug'}, '33': {'abbreviation': 'cnce', 'type_unique_identifier': 'T077', 'full_semantic_type_name': 'Conceptual Entity'}, '34': {'abbreviation': 'comd', 'type_unique_identifier': 'T049', 'full_semantic_type_name': 'Cell or Molecular Dysfunction'}, '35': {'abbreviation': 'crbs', 'type_unique_identifier': 'T088', 'full_semantic_type_name': 'Carbohydrate Sequence'}, '36': {'abbreviation': 'diap', 'type_unique_identifier': 'T060', 'full_semantic_type_name': 'Diagnostic Procedure'}, '37': {'abbreviation': 'dora', 'type_unique_identifier': 'T056', 'full_semantic_type_name': 'Daily or Recreational Activity'}, '38': {'abbreviation': 'drdd', 'type_unique_identifier': 'T203', 'full_semantic_type_name': 'Drug Delivery Device'}, '39': {'abbreviation': 'dsyn', 'type_unique_identifier': 'T047', 'full_semantic_type_name': 'Disease or Syndrome'}, '40': {'abbreviation': 'edac', 'type_unique_identifier': 'T065', 'full_semantic_type_name': 'Educational Activity'}, '41': {'abbreviation': 'eehu', 'type_unique_identifier': 'T069', 'full_semantic_type_name': 'Environmental Effect of Humans'}, '42': {'abbreviation': 'elii', 'type_unique_identifier': 'T196', 'full_semantic_type_name': 'Element, Ion, or Isotope'}, '43': {'abbreviation': 'emod', 'type_unique_identifier': 'T050', 'full_semantic_type_name': 'Experimental Model of Disease'}, '44': {'abbreviation': 'emst', 'type_unique_identifier': 'T018', 'full_semantic_type_name': 'Embryonic Structure'}, '45': {'abbreviation': 'enty', 'type_unique_identifier': 'T071', 'full_semantic_type_name': 'Entity'}, '46': {'abbreviation': 'enzy', 'type_unique_identifier': 'T126', 'full_semantic_type_name': 'Enzyme'}, '47': {'abbreviation': 'euka', 'type_unique_identifier': 'T204', 'full_semantic_type_name': 'Eukaryote'}, '48': {'abbreviation': 'evnt', 'type_unique_identifier': 'T051', 'full_semantic_type_name': 'Event'}, '49': {'abbreviation': 'famg', 'type_unique_identifier': 'T099', 'full_semantic_type_name': 'Family Group'}, '50': {'abbreviation': 'ffas', 'type_unique_identifier': 'T021', 'full_semantic_type_name': 'Fully Formed Anatomical Structure'}, '51': {'abbreviation': 'fish', 'type_unique_identifier': 'T013', 'full_semantic_type_name': 'Fish'}, '52': {'abbreviation': 'fndg', 'type_unique_identifier': 'T033', 'full_semantic_type_name': 'Finding'}, '53': {'abbreviation': 'fngs', 'type_unique_identifier': 'T004', 'full_semantic_type_name': 'Fungus'}, '54': {'abbreviation': 'food', 'type_unique_identifier': 'T168', 'full_semantic_type_name': 'Food'}, '55': {'abbreviation': 'ftcn', 'type_unique_identifier': 'T169', 'full_semantic_type_name': 'Functional Concept'}, '56': {'abbreviation': 'genf', 'type_unique_identifier': 'T045', 'full_semantic_type_name': 'Genetic Function'}, '57': {'abbreviation': 'geoa', 'type_unique_identifier': 'T083', 'full_semantic_type_name': 'Geographic Area'}, '58': {'abbreviation': 'gngm', 'type_unique_identifier': 'T028', 'full_semantic_type_name': 'Gene or Genome'}, '59': {'abbreviation': 'gora', 'type_unique_identifier': 'T064', 'full_semantic_type_name': 'Governmental or Regulatory Activity'}, '60': {'abbreviation': 'grpa', 'type_unique_identifier': 'T102', 'full_semantic_type_name': 'Group Attribute'}, '61': {'abbreviation': 'grup', 'type_unique_identifier': 'T096', 'full_semantic_type_name': 'Group'}, '62': {'abbreviation': 'hcpp', 'type_unique_identifier': 'T068', 'full_semantic_type_name': 'Human-caused Phenomenon or Process'}, '63': {'abbreviation': 'hcro', 'type_unique_identifier': 'T093', 'full_semantic_type_name': 'Health Care Related Organization'}, '64': {'abbreviation': 'hlca', 'type_unique_identifier': 'T058', 'full_semantic_type_name': 'Health Care Activity'}, '65': {'abbreviation': 'hops', 'type_unique_identifier': 'T131', 'full_semantic_type_name': 'Hazardous or Poisonous Substance'}, '66': {'abbreviation': 'horm', 'type_unique_identifier': 'T125', 'full_semantic_type_name': 'Hormone'}, '67': {'abbreviation': 'humn', 'type_unique_identifier': 'T016', 'full_semantic_type_name': 'Human'}, '68': {'abbreviation': 'idcn', 'type_unique_identifier': 'T078', 'full_semantic_type_name': 'Idea or Concept'}, '69': {'abbreviation': 'imft', 'type_unique_identifier': 'T129', 'full_semantic_type_name': 'Immunologic Factor'}, '70': {'abbreviation': 'inbe', 'type_unique_identifier': 'T055', 'full_semantic_type_name': 'Individual Behavior'}, '71': {'abbreviation': 'inch', 'type_unique_identifier': 'T197', 'full_semantic_type_name': 'Inorganic Chemical'}, '72': {'abbreviation': 'inpo', 'type_unique_identifier': 'T037', 'full_semantic_type_name': 'Injury or Poisoning'}, '73': {'abbreviation': 'inpr', 'type_unique_identifier': 'T170', 'full_semantic_type_name': 'Intellectual Product'}, '74': {'abbreviation': 'irda', 'type_unique_identifier': 'T130', 'full_semantic_type_name': 'Indicator, Reagent, or Diagnostic Aid'}, '75': {'abbreviation': 'lang', 'type_unique_identifier': 'T171', 'full_semantic_type_name': 'Language'}, '76': {'abbreviation': 'lbpr', 'type_unique_identifier': 'T059', 'full_semantic_type_name': 'Laboratory Procedure'}, '77': {'abbreviation': 'lbtr', 'type_unique_identifier': 'T034', 'full_semantic_type_name': 'Laboratory or Test Result'}, '78': {'abbreviation': 'mamm', 'type_unique_identifier': 'T015', 'full_semantic_type_name': 'Mammal'}, '79': {'abbreviation': 'mbrt', 'type_unique_identifier': 'T063', 'full_semantic_type_name': 'Molecular Biology Research Technique'}, '80': {'abbreviation': 'mcha', 'type_unique_identifier': 'T066', 'full_semantic_type_name': 'Machine Activity'}, '81': {'abbreviation': 'medd', 'type_unique_identifier': 'T074', 'full_semantic_type_name': 'Medical Device'}, '82': {'abbreviation': 'menp', 'type_unique_identifier': 'T041', 'full_semantic_type_name': 'Mental Process'}, '83': {'abbreviation': 'mnob', 'type_unique_identifier': 'T073', 'full_semantic_type_name': 'Manufactured Object'}, '84': {'abbreviation': 'mobd', 'type_unique_identifier': 'T048', 'full_semantic_type_name': 'Mental or Behavioral Dysfunction'}, '85': {'abbreviation': 'moft', 'type_unique_identifier': 'T044', 'full_semantic_type_name': 'Molecular Function'}, '86': {'abbreviation': 'mosq', 'type_unique_identifier': 'T085', 'full_semantic_type_name': 'Molecular Sequence'}, '87': {'abbreviation': 'neop', 'type_unique_identifier': 'T191', 'full_semantic_type_name': 'Neoplastic Process'}, '88': {'abbreviation': 'nnon', 'type_unique_identifier': 'T114', 'full_semantic_type_name': 'Nucleic Acid, Nucleoside, or Nucleotide'}, '89': {'abbreviation': 'npop', 'type_unique_identifier': 'T070', 'full_semantic_type_name': 'Natural Phenomenon or Process'}, '90': {'abbreviation': 'nusq', 'type_unique_identifier': 'T086', 'full_semantic_type_name': 'Nucleotide Sequence'}, '91': {'abbreviation': 'ocac', 'type_unique_identifier': 'T057', 'full_semantic_type_name': 'Occupational Activity'}, '92': {'abbreviation': 'ocdi', 'type_unique_identifier': 'T090', 'full_semantic_type_name': 'Occupation or Discipline'}, '93': {'abbreviation': 'orch', 'type_unique_identifier': 'T109', 'full_semantic_type_name': 'Organic Chemical'}, '94': {'abbreviation': 'orga', 'type_unique_identifier': 'T032', 'full_semantic_type_name': 'Organism Attribute'}, '95': {'abbreviation': 'orgf', 'type_unique_identifier': 'T040', 'full_semantic_type_name': 'Organism Function'}, '96': {'abbreviation': 'orgm', 'type_unique_identifier': 'T001', 'full_semantic_type_name': 'Organism'}, '97': {'abbreviation': 'orgt', 'type_unique_identifier': 'T092', 'full_semantic_type_name': 'Organization'}, '98': {'abbreviation': 'ortf', 'type_unique_identifier': 'T042', 'full_semantic_type_name': 'Organ or Tissue Function'}, '99': {'abbreviation': 'patf', 'type_unique_identifier': 'T046', 'full_semantic_type_name': 'Pathologic Function'}, '100': {'abbreviation': 'phob', 'type_unique_identifier': 'T072', 'full_semantic_type_name': 'Physical Object'}, '101': {'abbreviation': 'phpr', 'type_unique_identifier': 'T067', 'full_semantic_type_name': 'Phenomenon or Process'}, '102': {'abbreviation': 'phsf', 'type_unique_identifier': 'T039', 'full_semantic_type_name': 'Physiologic Function'}, '103': {'abbreviation': 'phsu', 'type_unique_identifier': 'T121', 'full_semantic_type_name': 'Pharmacologic Substance'}, '104': {'abbreviation': 'plnt', 'type_unique_identifier': 'T002', 'full_semantic_type_name': 'Plant'}, '105': {'abbreviation': 'podg', 'type_unique_identifier': 'T101', 'full_semantic_type_name': 'Patient or Disabled Group'}, '106': {'abbreviation': 'popg', 'type_unique_identifier': 'T098', 'full_semantic_type_name': 'Population Group'}, '107': {'abbreviation': 'prog', 'type_unique_identifier': 'T097', 'full_semantic_type_name': 'Professional or Occupational Group'}, '108': {'abbreviation': 'pros', 'type_unique_identifier': 'T094', 'full_semantic_type_name': 'Professional Society'}, '109': {'abbreviation': 'qlco', 'type_unique_identifier': 'T080', 'full_semantic_type_name': 'Qualitative Concept'}, '110': {'abbreviation': 'qnco', 'type_unique_identifier': 'T081', 'full_semantic_type_name': 'Quantitative Concept'}, '111': {'abbreviation': 'rcpt', 'type_unique_identifier': 'T192', 'full_semantic_type_name': 'Receptor'}, '112': {'abbreviation': 'rept', 'type_unique_identifier': 'T014', 'full_semantic_type_name': 'Reptile'}, '113': {'abbreviation': 'resa', 'type_unique_identifier': 'T062', 'full_semantic_type_name': 'Research Activity'}, '114': {'abbreviation': 'resd', 'type_unique_identifier': 'T075', 'full_semantic_type_name': 'Research Device'}, '115': {'abbreviation': 'rnlw', 'type_unique_identifier': 'T089', 'full_semantic_type_name': 'Regulation or Law'}, '116': {'abbreviation': 'sbst', 'type_unique_identifier': 'T167', 'full_semantic_type_name': 'Substance'}, '117': {'abbreviation': 'shro', 'type_unique_identifier': 'T095', 'full_semantic_type_name': 'Self-help or Relief Organization'}, '118': {'abbreviation': 'socb', 'type_unique_identifier': 'T054', 'full_semantic_type_name': 'Social Behavior'}, '119': {'abbreviation': 'sosy', 'type_unique_identifier': 'T184', 'full_semantic_type_name': 'Sign or Symptom'}, '120': {'abbreviation': 'spco', 'type_unique_identifier': 'T082', 'full_semantic_type_name': 'Spatial Concept'}, '121': {'abbreviation': 'tisu', 'type_unique_identifier': 'T024', 'full_semantic_type_name': 'Tissue'}, '122': {'abbreviation': 'tmco', 'type_unique_identifier': 'T079', 'full_semantic_type_name': 'Temporal Concept'}, '123': {'abbreviation': 'topp', 'type_unique_identifier': 'T061', 'full_semantic_type_name': 'Therapeutic or Preventive Procedure'}, '124': {'abbreviation': 'virs', 'type_unique_identifier': 'T005', 'full_semantic_type_name': 'Virus'}, '125': {'abbreviation': 'vita', 'type_unique_identifier': 'T127', 'full_semantic_type_name': 'Vitamin'}, '126': {'abbreviation': 'vtbt', 'type_unique_identifier': 'T010', 'full_semantic_type_name': 'Vertebrate'}}

    abbreviation = []
    type_unique_identifier = []
    full_semantic_type_name = []

    for i in range(len(previous_dict)):
        abbreviation.append(previous_dict.get(f'{i}').get('abbreviation'))
        type_unique_identifier.append(previous_dict.get(f'{i}').get('type_unique_identifier'))
        full_semantic_type_name.append(previous_dict.get(f'{i}').get('full_semantic_type_name'))

    dict = {'abbreviation': abbreviation, 'type_unique_identifier': type_unique_identifier, 'full_semantic_type_name': full_semantic_type_name} 
    df_semantictypes = pd.DataFrame(dict)
    result = df_semantictypes.to_json(orient="index")
    with zipfile.ZipFile(f"./output_ParallelPyMetaMap_{column_name}_{out_form}/extra_resources/df_semantictypes.json.zip", mode="w", compression=zipfile.ZIP_DEFLATED, compresslevel=9) as zip_file:
        dumped_JSON: str = json.dumps(result, indent=4)
        zip_file.writestr("df_semantictypes.json", data=dumped_JSON)
        zip_file.testzip()
    zip_file.close()
