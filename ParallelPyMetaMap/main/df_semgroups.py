import requests
import pickle
import json
import pandas as pd
import zipfile

def df_semgroups(column_name, out_form):  
    previous_dict = {"0":{"semantic_group_abbrev":"ACTI","semantic_group_name":"Activities & Behaviors","type_unique_identifier":"T052","full_semantic_type_name":"Activity"},"1":{"semantic_group_abbrev":"ACTI","semantic_group_name":"Activities & Behaviors","type_unique_identifier":"T053","full_semantic_type_name":"Behavior"},"2":{"semantic_group_abbrev":"ACTI","semantic_group_name":"Activities & Behaviors","type_unique_identifier":"T056","full_semantic_type_name":"Daily or Recreational Activity"},"3":{"semantic_group_abbrev":"ACTI","semantic_group_name":"Activities & Behaviors","type_unique_identifier":"T051","full_semantic_type_name":"Event"},"4":{"semantic_group_abbrev":"ACTI","semantic_group_name":"Activities & Behaviors","type_unique_identifier":"T064","full_semantic_type_name":"Governmental or Regulatory Activity"},"5":{"semantic_group_abbrev":"ACTI","semantic_group_name":"Activities & Behaviors","type_unique_identifier":"T055","full_semantic_type_name":"Individual Behavior"},"6":{"semantic_group_abbrev":"ACTI","semantic_group_name":"Activities & Behaviors","type_unique_identifier":"T066","full_semantic_type_name":"Machine Activity"},"7":{"semantic_group_abbrev":"ACTI","semantic_group_name":"Activities & Behaviors","type_unique_identifier":"T057","full_semantic_type_name":"Occupational Activity"},"8":{"semantic_group_abbrev":"ACTI","semantic_group_name":"Activities & Behaviors","type_unique_identifier":"T054","full_semantic_type_name":"Social Behavior"},"9":{"semantic_group_abbrev":"ANAT","semantic_group_name":"Anatomy","type_unique_identifier":"T017","full_semantic_type_name":"Anatomical Structure"},"10":{"semantic_group_abbrev":"ANAT","semantic_group_name":"Anatomy","type_unique_identifier":"T029","full_semantic_type_name":"Body Location or Region"},"11":{"semantic_group_abbrev":"ANAT","semantic_group_name":"Anatomy","type_unique_identifier":"T023","full_semantic_type_name":"Body Part, Organ, or Organ Component"},"12":{"semantic_group_abbrev":"ANAT","semantic_group_name":"Anatomy","type_unique_identifier":"T030","full_semantic_type_name":"Body Space or Junction"},"13":{"semantic_group_abbrev":"ANAT","semantic_group_name":"Anatomy","type_unique_identifier":"T031","full_semantic_type_name":"Body Substance"},"14":{"semantic_group_abbrev":"ANAT","semantic_group_name":"Anatomy","type_unique_identifier":"T022","full_semantic_type_name":"Body System"},"15":{"semantic_group_abbrev":"ANAT","semantic_group_name":"Anatomy","type_unique_identifier":"T025","full_semantic_type_name":"Cell"},"16":{"semantic_group_abbrev":"ANAT","semantic_group_name":"Anatomy","type_unique_identifier":"T026","full_semantic_type_name":"Cell Component"},"17":{"semantic_group_abbrev":"ANAT","semantic_group_name":"Anatomy","type_unique_identifier":"T018","full_semantic_type_name":"Embryonic Structure"},"18":{"semantic_group_abbrev":"ANAT","semantic_group_name":"Anatomy","type_unique_identifier":"T021","full_semantic_type_name":"Fully Formed Anatomical Structure"},"19":{"semantic_group_abbrev":"ANAT","semantic_group_name":"Anatomy","type_unique_identifier":"T024","full_semantic_type_name":"Tissue"},"20":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T116","full_semantic_type_name":"Amino Acid, Peptide, or Protein"},"21":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T195","full_semantic_type_name":"Antibiotic"},"22":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T123","full_semantic_type_name":"Biologically Active Substance"},"23":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T122","full_semantic_type_name":"Biomedical or Dental Material"},"24":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T103","full_semantic_type_name":"Chemical"},"25":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T120","full_semantic_type_name":"Chemical Viewed Functionally"},"26":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T104","full_semantic_type_name":"Chemical Viewed Structurally"},"27":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T200","full_semantic_type_name":"Clinical Drug"},"28":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T196","full_semantic_type_name":"Element, Ion, or Isotope"},"29":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T126","full_semantic_type_name":"Enzyme"},"30":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T131","full_semantic_type_name":"Hazardous or Poisonous Substance"},"31":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T125","full_semantic_type_name":"Hormone"},"32":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T129","full_semantic_type_name":"Immunologic Factor"},"33":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T130","full_semantic_type_name":"Indicator, Reagent, or Diagnostic Aid"},"34":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T197","full_semantic_type_name":"Inorganic Chemical"},"35":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T114","full_semantic_type_name":"Nucleic Acid, Nucleoside, or Nucleotide"},"36":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T109","full_semantic_type_name":"Organic Chemical"},"37":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T121","full_semantic_type_name":"Pharmacologic Substance"},"38":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T192","full_semantic_type_name":"Receptor"},"39":{"semantic_group_abbrev":"CHEM","semantic_group_name":"Chemicals & Drugs","type_unique_identifier":"T127","full_semantic_type_name":"Vitamin"},"40":{"semantic_group_abbrev":"CONC","semantic_group_name":"Concepts & Ideas","type_unique_identifier":"T185","full_semantic_type_name":"Classification"},"41":{"semantic_group_abbrev":"CONC","semantic_group_name":"Concepts & Ideas","type_unique_identifier":"T077","full_semantic_type_name":"Conceptual Entity"},"42":{"semantic_group_abbrev":"CONC","semantic_group_name":"Concepts & Ideas","type_unique_identifier":"T169","full_semantic_type_name":"Functional Concept"},"43":{"semantic_group_abbrev":"CONC","semantic_group_name":"Concepts & Ideas","type_unique_identifier":"T102","full_semantic_type_name":"Group Attribute"},"44":{"semantic_group_abbrev":"CONC","semantic_group_name":"Concepts & Ideas","type_unique_identifier":"T078","full_semantic_type_name":"Idea or Concept"},"45":{"semantic_group_abbrev":"CONC","semantic_group_name":"Concepts & Ideas","type_unique_identifier":"T170","full_semantic_type_name":"Intellectual Product"},"46":{"semantic_group_abbrev":"CONC","semantic_group_name":"Concepts & Ideas","type_unique_identifier":"T171","full_semantic_type_name":"Language"},"47":{"semantic_group_abbrev":"CONC","semantic_group_name":"Concepts & Ideas","type_unique_identifier":"T080","full_semantic_type_name":"Qualitative Concept"},"48":{"semantic_group_abbrev":"CONC","semantic_group_name":"Concepts & Ideas","type_unique_identifier":"T081","full_semantic_type_name":"Quantitative Concept"},"49":{"semantic_group_abbrev":"CONC","semantic_group_name":"Concepts & Ideas","type_unique_identifier":"T089","full_semantic_type_name":"Regulation or Law"},"50":{"semantic_group_abbrev":"CONC","semantic_group_name":"Concepts & Ideas","type_unique_identifier":"T082","full_semantic_type_name":"Spatial Concept"},"51":{"semantic_group_abbrev":"CONC","semantic_group_name":"Concepts & Ideas","type_unique_identifier":"T079","full_semantic_type_name":"Temporal Concept"},"52":{"semantic_group_abbrev":"DEVI","semantic_group_name":"Devices","type_unique_identifier":"T203","full_semantic_type_name":"Drug Delivery Device"},"53":{"semantic_group_abbrev":"DEVI","semantic_group_name":"Devices","type_unique_identifier":"T074","full_semantic_type_name":"Medical Device"},"54":{"semantic_group_abbrev":"DEVI","semantic_group_name":"Devices","type_unique_identifier":"T075","full_semantic_type_name":"Research Device"},"55":{"semantic_group_abbrev":"DISO","semantic_group_name":"Disorders","type_unique_identifier":"T020","full_semantic_type_name":"Acquired Abnormality"},"56":{"semantic_group_abbrev":"DISO","semantic_group_name":"Disorders","type_unique_identifier":"T190","full_semantic_type_name":"Anatomical Abnormality"},"57":{"semantic_group_abbrev":"DISO","semantic_group_name":"Disorders","type_unique_identifier":"T049","full_semantic_type_name":"Cell or Molecular Dysfunction"},"58":{"semantic_group_abbrev":"DISO","semantic_group_name":"Disorders","type_unique_identifier":"T019","full_semantic_type_name":"Congenital Abnormality"},"59":{"semantic_group_abbrev":"DISO","semantic_group_name":"Disorders","type_unique_identifier":"T047","full_semantic_type_name":"Disease or Syndrome"},"60":{"semantic_group_abbrev":"DISO","semantic_group_name":"Disorders","type_unique_identifier":"T050","full_semantic_type_name":"Experimental Model of Disease"},"61":{"semantic_group_abbrev":"DISO","semantic_group_name":"Disorders","type_unique_identifier":"T033","full_semantic_type_name":"Finding"},"62":{"semantic_group_abbrev":"DISO","semantic_group_name":"Disorders","type_unique_identifier":"T037","full_semantic_type_name":"Injury or Poisoning"},"63":{"semantic_group_abbrev":"DISO","semantic_group_name":"Disorders","type_unique_identifier":"T048","full_semantic_type_name":"Mental or Behavioral Dysfunction"},"64":{"semantic_group_abbrev":"DISO","semantic_group_name":"Disorders","type_unique_identifier":"T191","full_semantic_type_name":"Neoplastic Process"},"65":{"semantic_group_abbrev":"DISO","semantic_group_name":"Disorders","type_unique_identifier":"T046","full_semantic_type_name":"Pathologic Function"},"66":{"semantic_group_abbrev":"DISO","semantic_group_name":"Disorders","type_unique_identifier":"T184","full_semantic_type_name":"Sign or Symptom"},"67":{"semantic_group_abbrev":"GENE","semantic_group_name":"Genes & Molecular Sequences","type_unique_identifier":"T087","full_semantic_type_name":"Amino Acid Sequence"},"68":{"semantic_group_abbrev":"GENE","semantic_group_name":"Genes & Molecular Sequences","type_unique_identifier":"T088","full_semantic_type_name":"Carbohydrate Sequence"},"69":{"semantic_group_abbrev":"GENE","semantic_group_name":"Genes & Molecular Sequences","type_unique_identifier":"T028","full_semantic_type_name":"Gene or Genome"},"70":{"semantic_group_abbrev":"GENE","semantic_group_name":"Genes & Molecular Sequences","type_unique_identifier":"T085","full_semantic_type_name":"Molecular Sequence"},"71":{"semantic_group_abbrev":"GENE","semantic_group_name":"Genes & Molecular Sequences","type_unique_identifier":"T086","full_semantic_type_name":"Nucleotide Sequence"},"72":{"semantic_group_abbrev":"GEOG","semantic_group_name":"Geographic Areas","type_unique_identifier":"T083","full_semantic_type_name":"Geographic Area"},"73":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T100","full_semantic_type_name":"Age Group"},"74":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T011","full_semantic_type_name":"Amphibian"},"75":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T008","full_semantic_type_name":"Animal"},"76":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T194","full_semantic_type_name":"Archaeon"},"77":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T007","full_semantic_type_name":"Bacterium"},"78":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T012","full_semantic_type_name":"Bird"},"79":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T204","full_semantic_type_name":"Eukaryote"},"80":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T099","full_semantic_type_name":"Family Group"},"81":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T013","full_semantic_type_name":"Fish"},"82":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T004","full_semantic_type_name":"Fungus"},"83":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T096","full_semantic_type_name":"Group"},"84":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T016","full_semantic_type_name":"Human"},"85":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T015","full_semantic_type_name":"Mammal"},"86":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T001","full_semantic_type_name":"Organism"},"87":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T101","full_semantic_type_name":"Patient or Disabled Group"},"88":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T002","full_semantic_type_name":"Plant"},"89":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T098","full_semantic_type_name":"Population Group"},"90":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T097","full_semantic_type_name":"Professional or Occupational Group"},"91":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T014","full_semantic_type_name":"Reptile"},"92":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T010","full_semantic_type_name":"Vertebrate"},"93":{"semantic_group_abbrev":"LIVB","semantic_group_name":"Living Beings","type_unique_identifier":"T005","full_semantic_type_name":"Virus"},"94":{"semantic_group_abbrev":"OBJC","semantic_group_name":"Objects","type_unique_identifier":"T071","full_semantic_type_name":"Entity"},"95":{"semantic_group_abbrev":"OBJC","semantic_group_name":"Objects","type_unique_identifier":"T168","full_semantic_type_name":"Food"},"96":{"semantic_group_abbrev":"OBJC","semantic_group_name":"Objects","type_unique_identifier":"T073","full_semantic_type_name":"Manufactured Object"},"97":{"semantic_group_abbrev":"OBJC","semantic_group_name":"Objects","type_unique_identifier":"T072","full_semantic_type_name":"Physical Object"},"98":{"semantic_group_abbrev":"OBJC","semantic_group_name":"Objects","type_unique_identifier":"T167","full_semantic_type_name":"Substance"},"99":{"semantic_group_abbrev":"OCCU","semantic_group_name":"Occupations","type_unique_identifier":"T091","full_semantic_type_name":"Biomedical Occupation or Discipline"},"100":{"semantic_group_abbrev":"OCCU","semantic_group_name":"Occupations","type_unique_identifier":"T090","full_semantic_type_name":"Occupation or Discipline"},"101":{"semantic_group_abbrev":"ORGA","semantic_group_name":"Organizations","type_unique_identifier":"T093","full_semantic_type_name":"Health Care Related Organization"},"102":{"semantic_group_abbrev":"ORGA","semantic_group_name":"Organizations","type_unique_identifier":"T092","full_semantic_type_name":"Organization"},"103":{"semantic_group_abbrev":"ORGA","semantic_group_name":"Organizations","type_unique_identifier":"T094","full_semantic_type_name":"Professional Society"},"104":{"semantic_group_abbrev":"ORGA","semantic_group_name":"Organizations","type_unique_identifier":"T095","full_semantic_type_name":"Self-help or Relief Organization"},"105":{"semantic_group_abbrev":"PHEN","semantic_group_name":"Phenomena","type_unique_identifier":"T038","full_semantic_type_name":"Biologic Function"},"106":{"semantic_group_abbrev":"PHEN","semantic_group_name":"Phenomena","type_unique_identifier":"T069","full_semantic_type_name":"Environmental Effect of Humans"},"107":{"semantic_group_abbrev":"PHEN","semantic_group_name":"Phenomena","type_unique_identifier":"T068","full_semantic_type_name":"Human-caused Phenomenon or Process"},"108":{"semantic_group_abbrev":"PHEN","semantic_group_name":"Phenomena","type_unique_identifier":"T034","full_semantic_type_name":"Laboratory or Test Result"},"109":{"semantic_group_abbrev":"PHEN","semantic_group_name":"Phenomena","type_unique_identifier":"T070","full_semantic_type_name":"Natural Phenomenon or Process"},"110":{"semantic_group_abbrev":"PHEN","semantic_group_name":"Phenomena","type_unique_identifier":"T067","full_semantic_type_name":"Phenomenon or Process"},"111":{"semantic_group_abbrev":"PHYS","semantic_group_name":"Physiology","type_unique_identifier":"T043","full_semantic_type_name":"Cell Function"},"112":{"semantic_group_abbrev":"PHYS","semantic_group_name":"Physiology","type_unique_identifier":"T201","full_semantic_type_name":"Clinical Attribute"},"113":{"semantic_group_abbrev":"PHYS","semantic_group_name":"Physiology","type_unique_identifier":"T045","full_semantic_type_name":"Genetic Function"},"114":{"semantic_group_abbrev":"PHYS","semantic_group_name":"Physiology","type_unique_identifier":"T041","full_semantic_type_name":"Mental Process"},"115":{"semantic_group_abbrev":"PHYS","semantic_group_name":"Physiology","type_unique_identifier":"T044","full_semantic_type_name":"Molecular Function"},"116":{"semantic_group_abbrev":"PHYS","semantic_group_name":"Physiology","type_unique_identifier":"T032","full_semantic_type_name":"Organism Attribute"},"117":{"semantic_group_abbrev":"PHYS","semantic_group_name":"Physiology","type_unique_identifier":"T040","full_semantic_type_name":"Organism Function"},"118":{"semantic_group_abbrev":"PHYS","semantic_group_name":"Physiology","type_unique_identifier":"T042","full_semantic_type_name":"Organ or Tissue Function"},"119":{"semantic_group_abbrev":"PHYS","semantic_group_name":"Physiology","type_unique_identifier":"T039","full_semantic_type_name":"Physiologic Function"},"120":{"semantic_group_abbrev":"PROC","semantic_group_name":"Procedures","type_unique_identifier":"T060","full_semantic_type_name":"Diagnostic Procedure"},"121":{"semantic_group_abbrev":"PROC","semantic_group_name":"Procedures","type_unique_identifier":"T065","full_semantic_type_name":"Educational Activity"},"122":{"semantic_group_abbrev":"PROC","semantic_group_name":"Procedures","type_unique_identifier":"T058","full_semantic_type_name":"Health Care Activity"},"123":{"semantic_group_abbrev":"PROC","semantic_group_name":"Procedures","type_unique_identifier":"T059","full_semantic_type_name":"Laboratory Procedure"},"124":{"semantic_group_abbrev":"PROC","semantic_group_name":"Procedures","type_unique_identifier":"T063","full_semantic_type_name":"Molecular Biology Research Technique"},"125":{"semantic_group_abbrev":"PROC","semantic_group_name":"Procedures","type_unique_identifier":"T062","full_semantic_type_name":"Research Activity"},"126":{"semantic_group_abbrev":"PROC","semantic_group_name":"Procedures","type_unique_identifier":"T061","full_semantic_type_name":"Therapeutic or Preventive Procedure"}}
    semantic_group_abbrev = []
    semantic_group_name = []
    type_unique_identifier = []
    full_semantic_type_name = []
    for i in range(len(previous_dict)):
        semantic_group_abbrev.append(previous_dict.get(f'{i}').get('semantic_group_abbrev'))
        semantic_group_name.append(previous_dict.get(f'{i}').get('semantic_group_name'))
        type_unique_identifier.append(previous_dict.get(f'{i}').get('type_unique_identifier'))
        full_semantic_type_name.append(previous_dict.get(f'{i}').get('full_semantic_type_name'))
    dict = {'semantic_group_abbrev': semantic_group_abbrev, 'semantic_group_name' : semantic_group_name, 'type_unique_identifier': type_unique_identifier, 'full_semantic_type_name': full_semantic_type_name} 
    df_semgroups = pd.DataFrame(dict)
    result = df_semgroups.to_json(orient="index")
    with zipfile.ZipFile(f"./output_ParallelPyMetaMap_{column_name}_{out_form}/extra_resources/df_semgroups.json.zip", mode="w", compression=zipfile.ZIP_DEFLATED, compresslevel=9) as zip_file:
        dumped_JSON: str = json.dumps(result, indent=4)
        zip_file.writestr("df_semgroups.json", data=dumped_JSON)
        zip_file.testzip()
    zip_file.close()
